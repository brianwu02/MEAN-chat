function AppCtrl(e,n){e.messages=[],n.on("init",function(n){e.name=n.name,e.users=n.users}),n.on("send:message",function(n){e.messages.push(n),console.log("socket:send:message called")}),n.on("change:name",function(e){s(e.oldName,e.newName),console.log("socket:change:name called")}),n.on("user:join",function(n){e.messages.push({user:"chatroom",text:"User "+n.name+" has joined."}),e.users.push(n.name),console.log("socket:user:join called")}),n.on("user:left",function(n){e.messages.push({user:"chatroom",text:"User "+n.name+" has left."});var s;for(s=0;s<e.users.length;s++)if(n.name==e.users[s]){e.users.splice(s,1);break}console.log("socket:user:left called")});var s=function(n,s){var o;for(o=0;o<e.users.length;o++)if(e.users[o]==n){e.users[o]=s;break}e.messages.push({user:"chatroom",text:"User "+n+"is now known as "+s+"."})};e.changeName=function(){console.log("socket:changename: called"),n.emit("change:name",{name:e.newName},function(n){n?(console.log("$scope.name: "+e.name),console.log("$scope.newName: "+e.newName),s(e.name,e.newName),e.name=e.newName,e.newName=""):(console.log("!result happened"),alert("your name cannot be changed, sorry"))})},e.sendMessage=function(){n.emit("send:message",{message:e.message}),e.messages.push({user:e.name,text:e.message}),e.message="",console.log("socket:send:message called")}}var app=angular.module("myApp",["myApp.filters","myApp.directives","ui.bootstrap"]);angular.module("myApp.directives",[]).directive("appVersion",["version",function(e){return function(n,s){s.text(e)}}]),angular.module("myApp.filters",[]).filter("interpolate",["version",function(e){return function(n){return String(n).replace(/\%VERSION\%/gm,e)}}]),app.factory("socket",function(e){var n=io.connect();return{on:function(s,o){n.on(s,function(){var s=arguments;e.$apply(function(){o&&o.apply(n,s)})})},emit:function(s,o,a){n.emit(s,o,function(){var s=arguments;e.$apply(function(){a&&a.apply(n,s)})})}}});